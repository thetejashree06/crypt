#include <stdio.h>

int mod26(int x) {
    x %= 26;
    return (x < 0) ? x + 26 : x;
}

int modInverse(int a) {
    for (int i = 1; i < 26; i++)
        if ((a * i) % 26 == 1)
            return i;
    return -1;
}

int main() {
    int P[2][2] = {{7, 4}, {11, 15}};    // plaintext matrix
    int C[2][2] = {{7, 8}, {19, 17}};   // ciphertext matrix

    int det = mod26(P[0][0]*P[1][1] - P[0][1]*P[1][0]);
    int detInv = modInverse(det);

    if (detInv == -1) {
        printf("Plaintext matrix not invertible\n");
        return 0;
    }

    int Pinv[2][2];
    Pinv[0][0] =  mod26( P[1][1] * detInv);
    Pinv[0][1] =  mod26(-P[0][1] * detInv);
    Pinv[1][0] =  mod26(-P[1][0] * detInv);
    Pinv[1][1] =  mod26( P[0][0] * detInv);

    int K[2][2];
    for (int i = 0; i < 2; i++)
        for (int j = 0; j < 2; j++)
            K[i][j] = mod26(
                C[i][0] * Pinv[0][j] +
                C[i][1] * Pinv[1][j]
            );

    printf("Recovered Key Matrix:\n");
    printf("%d %d\n%d %d\n", K[0][0], K[0][1], K[1][0], K[1][1]);

    return 0;
}

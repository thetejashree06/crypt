from Crypto.Cipher import DES3
from Crypto.Random import get_random_bytes

def pad_message(message, block_size):
    """Pads the message using '1' followed by '0's up to the next block size."""
    padding_length = block_size - (len(message) % block_size)
    if padding_length == 0:
        padding_length = block_size  
    padding = b'\x80' + b'\x00' * (padding_length - 1)
    return message + padding

def cbc_encrypt_3des(plaintext, key, iv):
    cipher = DES3.new(key, DES3.MODE_CBC, iv)
    padded_text = pad_message(plaintext, DES3.block_size)
    return cipher.encrypt(padded_text)


key = DES3.adjust_key_parity(get_random_bytes(24))  
iv = get_random_bytes(8)  

plaintext = b"SensitiveData1234"  


ciphertext = cbc_encrypt_3des(plaintext, key, iv)


print("3DES CBC Encrypted:", ciphertext.hex())
